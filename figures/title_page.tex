\documentclass[tikz,crop]{standalone}
\input{preamble/tikz_standalone.tex}
\input{preamble/tikz_colors.tex}
\input{preamble/tikz_common.tex}
\input{preamble/tikz_style.tex}
\input{../preamble/title.tex}
\input{../preamble/abbreviations.tex}

\newlength{\figurewidth}
\setlength{\figurewidth}{170mm}
\newlength{\figureheight}
\setlength{\figureheight}{240mm}

\begin{document}
\begin{tikzpicture}[x=\figurewidth, y=\figureheight, every node/.style={inner sep=0}]
    % Background
    \tikzstyle{mean} = [smooth, SGreenDark, thick]
    \tikzstyle{std} = [smooth, sGreenDark!50!black, thick]
    \tikzstyle{std fill} = [sGreenDark]
    \tikzstyle{training data} = [smooth, very thick]
    \tikzstyle{test data} = [smooth, very thick, dashed]
    \tikzstyle{sample} = [smooth, thin]
    \begin{axis}[
        at={(0.5\figurewidth, 0.6\figureheight)},
        anchor=center,
        height=1.1\figureheight,
        width=1.1\figurewidth,
        axis x line=none,
        axis y line=none,
        xmin=-0.6, xmax=-0.3,
        ymin=-1.5, ymax=2.5,
        ]

        \addplot[std, name path=plus]
            table[
            ignore chars={\#}, col sep=space,
            x=X, y expr=\thisrow{mu} + \thisrow{2std}
            ] {data/wind/wind_one_joint_sample.dat};
        \addplot[std, name path=minus]
            table[
            ignore chars={\#}, col sep=space,
            x=X, y expr=\thisrow{mu} - \thisrow{2std}
            ] {data/wind/wind_one_joint_sample.dat};
        \addplot[std fill] fill between[of=plus and minus, soft clip={domain=-0.6:-0.3}];
        % \addplot[mean]
        %     table[
        %     restrict x to domain=-0.6:-0.3,
        %     ignore chars={\#}, col sep=space,
        %     x=X, y=mu
        %     ] {data/wind/wind_one_joint_sample.dat};

        \addplot[
            training data,
            ] table[
            ignore chars={\#}, col sep=space,
            restrict x to domain=-.7:-.5,
            x=X, y=Y
            ] {data/wind/wind_one_data.dat};
        \addplot[
            training data,
            ] table[
            ignore chars={\#}, col sep=space,
            restrict x to domain=-.4:-.2,
            x=X, y=Y
            ] {data/wind/wind_one_data.dat};
        \addplot[
            test data,
            ] table[
            ignore chars={\#}, col sep=space,
            restrict x to domain=-.5:-.4,
            x=X, y=Y
            ] {data/wind/wind_hole_data.dat};

        \foreach \ix in {0,...,4}
        \addplot[sample] table[restrict x to domain=-0.601:-0.3, ignore chars={\#}, col sep=space, x=X, y=posterior] {data/wind/wind_alignment_sample_\ix.dat};
    \end{axis}
    \draw[white, opacity=0.75, fill=white] (0, 0) rectangle (1, 1);

    % Foreground
    % \tikzstyle{date} = [font=\normalsize]
    \tikzstyle{chairs} = [font=\normalsize, text width=15cm, align=right]
    \tikzstyle{thesis} = [font=\LARGE]
    \tikzstyle{author} = [font=\huge\bfseries]
    \tikzstyle{title} = [sTealDark, font=\Huge\bfseries]
    \tikzstyle{title bar} = [title, line width=2pt, line cap=round]

    \node[anchor=east, author] (author) at (0.95, 0.9) {\makeatletter\@author\makeatother};
    \node[anchor=east] (logos) at (0.95, 0.1) {
        \includegraphics[height=2cm,width=4cm,keepaspectratio]{tum}
    };
    \node[anchor=east, left=1cm of logos] (siemens logo) {
        \includegraphics[height=2cm,width=4cm,keepaspectratio]{siemens_claim}
    };

    \node[anchor=south east, chairs] (chairs) at ($(logos.north east) + (0, 1cm)$) {
        \textbf{Chair for Foundations of Software Reliability\\ and Theoretical Computer Science}\\
        Department of Informatics\\
        Technische Universität München\\
        \bigskip
        \textbf{Learning Systems Group}\\
        CT RDA BAM LSY-DE\\
        Siemens AG\\
        \bigskip
        Submitted on \makeatletter\@date\makeatother
    };

    \coordinate (title height) at ($(author.south east)!0.5!(chairs.north east)$);
    \node[anchor=east] (title) at (title height -| 1,0) {
        \begin{tikzpicture}[x={(1.0,0)},y={(0,0.075)}]
            \node[thesis] (author) at (0.95, 1.25) {Dissertation};
            \draw[white, fill=white, opacity=0.75] (0, 0) rectangle (1, 1);
            \draw[title bar] (0, 1) -- (1, 1);
            \node[title] (title) at (0.95, 0.5) {\makeatletter\@title\makeatother};
            \draw[title bar] (0, 0) -- (1, 0);
            % \node[date] (date) at (0.95, -0.25) {Submitted on \makeatletter\@date\makeatother};
        \end{tikzpicture}
    };

    % NOTE(mrksr): There is a strange interaction between fillbetween and
    % explicitly setting the bounding box at the top. So we reset it at the
    % bottom after drawing is done.
    \pgfresetboundingbox
    \useasboundingbox (0, 0) rectangle (1, 1);
\end{tikzpicture}
\end{document}
