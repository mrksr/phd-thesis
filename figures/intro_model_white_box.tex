\documentclass[tikz,crop]{standalone}
\input{preamble/tikz_standalone.tex}
\input{preamble/tikz_colors.tex}
\input{preamble/tikz_common.tex}
\input{preamble/tikz_style.tex}
\input{../preamble/abbreviations.tex}

\begin{document}
\begin{tikzpicture}
    \begin{scope}[x=3em, y=8.5ex]
        \node[random variable, observed] (x) at (0, 5) {$\mat{x}$};
        \node[random variable, observed] (y) at (0, 0) {$\mat{y}$};

        % ---

        \node[white box component] (a) at (0, 4) {};
        \node[white box component] (b) at (-1, 3) {};
        \node[white box component] (c) at (1, 3) {};
        \node[white box component] (d) at (0, 2) {};
        \node[white box component] (e) at (0, 1) {};

        \node[white box component] (ca) at (-2, 4) {};
        \node[white box component] (cb) at (-1, 4) {};
        \node[white box component] (cc) at (2, 4) {};
        \node[white box component] (cd) at (2, 3) {};
        \node[white box component] (ce) at (-2, 3) {};
        \node[white box component] (cf) at (-2, 1) {};
        \node[white box component] (cg) at (-1, 1) {};

        % ---

        \draw[edge, directed] (x) -- (a);
        \draw[edge, directed] (a) -- (b);
        \draw[edge, directed] (a) -- (c);
        \draw[edge, directed] (b) -- (d);
        \draw[edge, directed] (c) -- (d);
        \draw[edge, directed] (d) -- (e);
        \draw[edge, directed] (e) -- (y);

        \draw[edge, directed] (ca) -- (cb);
        \draw[edge, directed] (cb) -- (b);
        \draw[edge, directed] (cc) -- (cd);
        \draw[edge, directed] (cd) -- (c);
        \draw[edge, directed] (ce) -- (b);
        \draw[edge, directed] (ce) -- (cf);
        \draw[edge, directed] (cf) -- (cg);
        \draw[edge, directed] (cg) -- (e);
    \end{scope}

    \begin{scope}[on background layer]
        \node[
        white box,
        fit=(cb)(cc)(ce)(e),
        ] {};
    \end{scope}
\end{tikzpicture}
\end{document}
